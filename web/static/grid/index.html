<!DOCTYPE html><html><head><base href=".."><link rel="stylesheet" type="text/css" href="assets/lib/bootstrap/main/dist/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/@loadingio/bootstrap.ext/main/index.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldiconfont/main/ldif.min.css"><link rel="stylesheet" type="text/css" href="assets/lib/ldcover/main/index.min.css"><link rel="stylesheet" type="text/css" href="css/index.css"><style type="text/css">html,body{width:100%;height:100%;background:#fff}.sheet{position:relative;border-width:1px;border-style:solid;border-color:#999;width:100%;height:100%;overflow:scroll}.sheet .inner{position:relative;z-index:1;display:grid;width:fit-content;height:fit-content}.sheet .cell{user-select:none;border-width:0 1px 1px 0;border-style:solid;border-color:#ddd;padding:1px;min-width:48px;min-height:26px;line-height:26px;flex:0 0 auto;box-sizing:border-box;white-space:pre;overflow:hidden}.sheet .cell.idx{position:sticky;background:#f1f2f3;color:#919293;font-size:.85em;text-align:center;user-select:none}.sheet .cell.idx.x{z-index:100;left:0}.sheet .cell.idx.y{z-index:101;top:0}.sheet .cell.idx.xy{z-index:102;top:0;left:0}.sheet .cell.debug{background:red}.sheet .range{z-index:10;border:1px solid #27f;user-select:none;opacity:0;pointer-events:none;top:0;left:0;position:absolute}.sheet .caret{z-index:11;border:2px solid #27f;user-select:none;opacity:0;pointer-events:none;top:0;left:0;position:absolute}.sheet .edit{z-index:21;border:2px solid #27f;opacity:0;pointer-events:none;top:0;left:0;position:absolute}.sheet .edit textarea{display:block;border:0;outline:0}.sheet .layout{display:inline-block;top:0;left:0;position:absolute;z-index:0;opacity:1;pointer-events:none;user-select:none;white-space:pre;padding-bottom:1.5em}.sheet .show{opacity:1 !important}</style></head><body><div class="w-1024 rwd mx-auto my-4"><div class="aspect-ratio ratio-2by1"><div class="container"></div></div></div><script type="text/javascript" src="assets/lib/proxise/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/json0/main/json0.min.js" defer></script><script type="text/javascript" src="assets/lib/bootstrap.native/main/dist/bootstrap-native.min.js" defer></script><script type="text/javascript" src="assets/lib/@loadingio/ldquery/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@loadingio/debounce.js/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/ldcover/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/ldview/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/datadom/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/csscope/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/@plotdb/rescope/main/index.min.js" defer></script><script type="text/javascript" src="assets/lib/dompurify/main/dist/purify.min.js" defer></script><script type="module">(function(t){return t.apply({})})(function(){var r,t,e;r=function(t){var e,i;if(t<0){return""}e="";do{i=t%26;e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(i)+e;t=(t-i)/26}while(t>0);return e};t=function(t){var e=this;t==null&&(t={});this.root=typeof t.root==="string"?document.querySelector(t.root):t.root;this.col=t.col||100;this.row=t.row||100;this.sel={};this.editing={};this.dom=Object.fromEntries(["sheet","inner","caret","range","edit","layout"].map(function(t){var e,i;e=i=document.createElement("div");e.classList.add(t);return[t,i]}));this.dom.textarea=document.createElement("textarea");this.root.appendChild(this.dom.sheet);["inner","caret","range","edit","layout"].map(function(t){return e.dom.sheet.appendChild(e.dom[t])});this.dom.edit.appendChild(this.dom.textarea);this._init();return this};t.prototype=import$(Object.create(Object.prototype),{_init:function(){var i,t,e,n,o,r,s,f=this;this.regrid();i=this.dom.sheet;for(t=0,e=this.row;t<e;++t){n=t;for(o=0,r=this.col;o<r;++o){s=o;this.addCell({r:n,c:s})}}i.addEventListener("mousedown",function(t){var e;f.edited();if(!(e=ld$.parent(t.target,".cell",i))){return}f.sel.start=f.sel.end=e;return f.renderSelection()});i.addEventListener("mousemove",function(t){var e;if(f.editing.on||!(t.buttons&&(e=ld$.parent(t.target,".cell",i)))){return}f.sel.end=e;return f.renderSelection()});i.addEventListener("dblclick",function(t){var e;if(!(e=ld$.parent(t.target,".cell",i))){return}return f.edit({node:e,quick:false})});document.body.addEventListener("keydown",function(t){var e,i,n,o,r,s,d,l,h,a,c,u,m;e=t.keyCode;if(e===8){if(!f.sel.start){return}i=f.index(f.sel.start);n=f.index(f.sel.end);o=Math.min(i.row,n.row);r=Math.max(i.row,n.row);s=Math.min(i.col,n.col);d=Math.max(i.col,n.col);for(l=o;l<=r;++l){h=l;for(a=s;a<=d;++a){c=a;u=f.cell({row:h,col:c});if(u){u.textContent=""}}}f.renderSelection()}m=function(){switch(e){case 37:return{row:0,col:-1};case 38:return{row:-1,col:0};case 39:return{row:0,col:1};case 40:return{row:1,col:0};default:return null}}();if(!m){return}if(f.editing.on&&!f.editing.quick){return}f.move(m);t.stopPropagation();return t.preventDefault()});document.body.addEventListener("keypress",function(t){if(f.sel.start&&!f.editing.on){return f.edit({node:f.sel.start,quick:true})}});this.dom.textarea.addEventListener("keydown",function(t){var e,i,n;if(t.keyCode===27||t.keyCode===13&&!(t.altKey||t.metaKey)){f.move({row:1,col:0});t.stopPropagation();t.preventDefault();return}if(t.keyCode===13&&(t.altKey||t.metaKey)){f.dom.textarea.value+="\n";f.dom.layout.textContent=f.dom.textarea.value;e=f.dom.layout.getBoundingClientRect();i=f.editing.node.getBoundingClientRect();return n=f.dom.textarea.style,n.width=Math.max(e.width,i.width+1)+"px",n.height=Math.max(e.height,i.height+1)+"px",n}});return this.dom.textarea.addEventListener("mousedown",function(t){return t.stopPropagation()})},move:function(t){var e;t==null&&(t={});if(this.editing.on){this.edited()}e=this.sel.start;t.node=e;if(!e){return}e=this.cell(t);if(!e){return}this.sel.start=e;this.sel.end=e;return this.renderSelection()},edit:function(t){var e,i,n,o,r,s,d,l;e=t.node,i=t.quick;n=this.editing;n.node=e;n.quick=i;n.on=true;this.dom.layout.textContent=e.textContent;o=this.dom.layout.getBoundingClientRect();r=e.getBoundingClientRect();s=this.dom.sheet.getBoundingClientRect();n=[this.dom.sheet.scrollLeft,this.dom.sheet.scrollTop],d=n[0],l=n[1];n=this.dom.edit.style;n.left=r.x-s.x+d-2+"px";n.top=r.y-s.y+l-2+"px";n.width="fit-content";n.height="fit-content";this.dom.edit.classList.toggle("show",true);n=this.dom.textarea.style;n.width=Math.max(o.width,r.width+1)+"px";n.height=Math.max(o.height,r.height+1)+"px";this.dom.textarea.value=i?"":e.textContent||"";return this.dom.textarea.focus()},edited:function(){var t,e=this;if(!this.editing.on){return}this.editing.node.textContent=this.dom.textarea.value||"";["edit","caret","range"].map(function(t){return e.dom[t].classList.toggle("show",false)});return t=this.editing,t.node=null,t.on=false,t},regrid:function(){return this.dom.inner.style.gridTemplateColumns="repeat("+this.col+", max-content)"},addCell:function(t){var e,i,n;e=t.r,i=t.c;n=document.createElement("div");n.classList.add.apply(n.classList,!(i||e)?["cell","idx","xy"]:!i?["cell","idx","x"]:!e?["cell","idx","y"]:["cell"]);n.textContent=!(i||e)?"":!i?e:!e?r(i-1):"";return this.dom.inner.insertBefore(n,this.dom.inner.childNodes[e*this.col+i])},insertCol:function(t){var e,i;for(e=this.row-1;e>=0;--e){i=e;this.addCell({r:i,c:t})}this.col=this.col+1;this.regrid();return this.reidx()},insertRow:function(t){var e,i,n;for(e=0,i=this.col;e<i;++e){n=e;this.addCell({r:t,c:n})}this.row=this.row+1;return this.reidx()},deleteCol:function(t){var e,i;for(e=this.row-1;e>=0;--e){i=e;this.dom.inner.removeChild(this.dom.inner.childNodes[i*this.col+t])}this.col=this.col-1;this.regrid();return this.reidx()},deleteRow:function(t){var e,i,n;for(e=0,i=this.col;e<i;++e){n=e;this.dom.inner.removeChild(this.dom.inner.childNodes[t*this.col])}this.row=this.row-1;return this.reidx()},reidx:function(){var t,e,i,n,o=[];for(t=0,e=this.row;t<e;++t){i=t;this.dom.inner.childNodes[i*this.col].textContent=i}for(t=0,e=this.col;t<e;++t){n=t;o.push(this.dom.inner.childNodes[n].textContent=r(n-1))}return o},setContent:function(t){var e,i,n,o;e=t.row,i=t.col,n=t.content;o=this.dom.inner.childNodes[e*this.col+i];return o.textContent=n},index:function(t){var e,i,n;e=Array.from(this.dom.inner.childNodes).indexOf(t);if(e<0){return null}i=e%this.col;n=(e-i)/this.col;return{row:n,col:i}},cell:function(t){var e,i,n;t==null&&(t={});e=t.node?this.index(t.node):{row:0,col:0};if(!e){throw new Error("node not found in sheet")}i=e.row+(t.row||0);n=e.col+(t.col||0);return this.dom.inner.childNodes[i*this.col+n]},renderSelection:function(){var t,e,i,n,o,r,s,d,l,h,a,c;t=this.sel.start.getBoundingClientRect();e=this.sel.end.getBoundingClientRect();i=this.dom.sheet.getBoundingClientRect();n=this.dom.sheet.scrollLeft;o=this.dom.sheet.scrollTop;r=Math.min(t.x,e.x)-i.x+n-2;s=Math.min(t.y,e.y)-i.y+o-2;d=Math.max(t.x+t.width,e.x+e.width)-i.x+n-2;l=Math.max(t.y+e.height,e.y+e.height)-i.y+o-2;h=d-r+1;a=l-s+1;c=this.dom.range.style;c.left=r+"px";c.top=s+"px";c.width=h+"px";c.height=a+"px";c=this.dom.caret.style;c.left=t.x-i.x+n-2+"px";c.top=t.y-i.y+o-2+"px";c.width=t.width+1+"px";c.height=t.height+1+"px";this.dom.range.classList.toggle("show",true);return this.dom.caret.classList.toggle("show",true)}});e=new t({root:".container"});e.insertCol(3);e.insertRow(2);e.deleteRow(2);e.deleteCol(3);return e.setContent({row:3,col:4,content:"this is a very long word.\nhello world!"})});function import$(t,e){var i={}.hasOwnProperty;for(var n in e)if(i.call(e,n))t[n]=e[n];return t}</script></body></html>