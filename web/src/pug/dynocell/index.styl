html, body { width: 100%; height: 100%; background: #fff; margin: 0; padding: 0 }

hide()
  opacity: 0
  //pointer-events: none
  display: none

initabs()
  top: 0
  left: 0
  position: absolute

.sheet
  position: relative
  width: 100%
  height: 100%
  overflow: hidden
  .inner
    position: absolute
    z-index: 1
    display: grid
    width: 100%
    height: 100%
    overflow: hidden
  .cell
    position: relative
    user-select: none
    border-width: 0 1px 1px 0
    border-style: solid
    border-color: #ddd
    /* use em may lead to nondeterminstic behavior in border rendering, due to rounding */
    padding: 1px 3px
    min-width: 48px
    //-min-height: 26px
    line-height: 26px
    box-sizing: border-box
    white-space: pre
  .cell.idx
    z-index: 100
    background: #f1f2f3
    color: #919293
    font-size: .85em
    text-align: center
    user-select: none
  .range
    z-index: 10
    border: 1px solid #27f
    user-select: none
    pointer-events: none
    hide()
    initabs()
  .caret
    z-index: 11
    border: 2px solid #27f
    user-select: none
    pointer-events: none
    hide()
    initabs()
  .edit
    z-index: 21
    border: 2px solid #27f
    hide()
    initabs()
    textarea
      display: block /* eliminate small gap between .edit and textarea */
      border: none
      outline: none
  .layout
    display: inline-block
    initabs()
    z-index: 0
    opacity: 0
    pointer-events: none
    user-select: none
    white-space: pre
  .show
    opacity: 1!important
    display: block

